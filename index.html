<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'self'; style-src 'self'; base-uri 'self'; form-action 'none';" />
  <meta name="referrer" content="no-referrer" />
  <title>Mirror CipherLab - ミラー系暗号化・難読化ツール</title>
  <meta name="description" content="Mirror cipher (text reversal & mirrored rendering) visualizer. All in browser." />
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <header class="app-header">
    <button id="themeToggle" class="theme-toggle" aria-label="テーマ切り替え">
      <span class="theme-toggle-icon" id="themeIcon">☀️</span>
    </button>
    <h1>Mirror CipherLab</h1>
    <p class="subtitle">ミラー（逆転値）暗号を「反転」、鏡文字を「鏡像レンダリング」で体験する</p>
  </header>

  <main class="container">

    <section class="panel panel-input">
      <div class="panel-header">
        <h2>📝 入力</h2>
      </div>

      <textarea id="input" placeholder="ここにテキストを入力してください（例）Mirror CipherLab へようこそ！" aria-label="入力テキスト"></textarea>

      <div class="btn-row">
        <button id="btnClear" class="btn btn-ghost">Clear</button>
        <button id="btnCopyIn" class="btn btn-ghost">Copy Input</button>
      </div>
    </section>

    <div class="flow-indicator">
      <div class="flow-arrow">↓</div>
      <div class="flow-label">リアルタイム変換</div>
    </div>

    <section class="panel panel-controls">
      <div class="panel-header">
        <h2>⚙️ 変換設定</h2>
      </div>

      <div class="controls-section">
        <div class="controls controls-grid">
          <label class="control" for="reversal">
            <span class="control-label">
              <span class="step-badge">Step 1</span>
              Reversal（反転方式）
            </span>
            <select id="reversal">
              <option value="full">Full Reverse（全文字を逆順）</option>
              <option value="word">Word-wise Reverse（単語ごとに逆順）</option>
              <option value="none">None（反転なし）</option>
            </select>
          </label>

          <label class="control" for="mirror">
            <span class="control-label">
              <span class="step-badge">Step 2</span>
              Glyph Mirror（鏡像表示）
            </span>
            <select id="mirror">
              <option value="none">None</option>
              <option value="h">Horizontal（左右鏡像）</option>
              <option value="v">Vertical（上下鏡像）</option>
            </select>
          </label>

          <label class="control" for="font">
            <span class="control-label">Font（フォント）</span>
            <select id="font">
              <option value="system-ui">System UI</option>
              <option value="serif">Serif</option>
              <option value="monospace">Monospace</option>
            </select>
          </label>
        </div>
      </div>
    </section>

    <div class="flow-indicator">
      <div class="flow-arrow">↓</div>
      <div class="flow-label">処理結果</div>
    </div>

    <section class="panel panel-output">
      <div class="panel-header">
        <h2>✨ 出力（プレビュー）</h2>
        <div class="info">
          <span id="charCount" aria-live="polite">0 chars</span>
        </div>
      </div>

      <div class="preview-wrap">
        <div class="preview-block">
          <div class="preview-label">
            <span class="step-number">Step 1</span>
            <span class="step-desc">Reversal</span>
          </div>
          <pre id="stepReversed" class="preview" aria-label="反転処理後のテキスト"></pre>
        </div>

        <div class="arrow" aria-hidden="true">→</div>

        <div class="preview-block">
          <div class="preview-label">
            <span class="step-number">Step 2</span>
            <span class="step-desc">Glyph Mirror</span>
          </div>
          <pre id="stepMirrored" class="preview mirror-none" aria-label="鏡像処理後のテキスト"></pre>
        </div>
      </div>

      <div class="btn-row">
        <button id="btnCopyOut" class="btn btn-accent">
          <span class="btn-icon">📋</span>
          Copy Output
        </button>
        <button id="btnDownload" class="btn btn-ghost">
          <span class="btn-icon">💾</span>
          Download .txt
        </button>
        <button id="btnShare" class="btn btn-primary">
          <span class="btn-icon">🔗</span>
          Share URL
        </button>
      </div>
    </section>
  </main>

  <section class="notes">
    <details open>
      <summary>💡 学習メモ（RTL/結合文字/絵文字など）</summary>
      <ul>
        <li><strong>鏡像レンダリング</strong>は CSS の見た目変形です。バイト列や文字順自体は変わりません。</li>
        <li><strong>反転（Full/Word-wise）</strong>は文字列の実順序を変更します。コピペ時は反転後のテキストになります。</li>
        <li>RTL（右→左）言語や結合文字・絵文字はブラウザー差異でレンダリングが異なることがあります。</li>
        <li>⚠️ 本ツールは教育用デモです。セキュリティ強度はありません。</li>
      </ul>
    </details>
  </section>

  <footer>
    <div class="footer">
      🔗 GitHubリポジトリはこちら（ <a href="https://github.com/ipusiron/mirror-cipherlab" target="_blank" rel="noopener noreferrer">ipusiron/mirror-cipherlab</a> ）
    </div>
  </footer>

  <div id="toast" role="status" aria-live="polite"></div>

  <script src="./script.js"></script>
</body>
</html>
